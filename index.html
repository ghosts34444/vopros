<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Собеседование — LoliMods</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: #1a1a2e;
            color: #e0e0ff;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin: 20px 0;
            color: #d8b4f8;
            font-size: 2.2rem;
        }
        .info-section {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .info-section input {
            flex: 1;
            min-width: 180px;
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #8b5cf6;
            background: #1a1a2e;
            color: #e0e0ff;
        }
        .controls {
            background: #16162a;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
        }
        .controls label {
            font-weight: 600;
        }
        input, button {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #8b5cf6;
            background: #1a1a2e;
            color: #e0e0ff;
        }
        button {
            background: linear-gradient(45deg, #8b5cf6, #6366f1);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(139, 92, 246, 0.4);
        }
        .total-score {
            text-align: center;
            font-size: 1.2rem;
            margin: 15px 0;
            color: #a5b4fc;
        }
        .total-score span {
            color: #d8b4f8;
            font-weight: bold;
        }
        .mod-section {
            background: #16162a;
            border: 1px solid #8b5cf6;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .mod-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            color: #d8b4f8;
        }
        .question-card {
            background: #1a1a2e;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 3px solid #8b5cf6;
        }
        .question-text {
            margin-bottom: 8px;
            font-weight: 500;
        }
        .answer {
            background: rgba(139, 92, 246, 0.15);
            padding: 8px;
            border-radius: 6px;
            margin: 6px 0;
            font-style: italic;
            font-size: 0.95rem;
            white-space: pre-wrap;
        }
        .score-buttons {
            display: flex;
            gap: 10px;
            margin-top: 6px;
        }
        .score-btn {
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
        }
        .score-btn.plus { background: #10b981; color: white; }
        .score-btn.minus { background: #ef4444; color: white; }
        .score-btn.active {
            transform: scale(1.1);
            box-shadow: 0 0 8px rgba(255,255,255,0.6);
        }
        .remove-btn {
            margin-left: auto;
            padding: 4px 8px;
            background: #4b5563;
            color: #e0e0ff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .export-section {
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Собеседование по модам</h1>

        <div class="info-section">
            <input type="text" id="interviewee" placeholder="Кто проходит собеседование">
            <input type="text" id="interviewer" placeholder="Кто проводит собеседование">
        </div>

        <div class="controls">
            <label>
                Вопросов на мод (1–23):
                <input type="number" id="question-count" min="1" max="23" value="5">
            </label>
            <button id="generate-btn">Сгенерировать</button>
            <button id="restore-btn">Вернуть все</button>
            <button id="export-btn">Сохранить отчёт (.json)</button>
        </div>

        <div class="total-score">
            Общий балл: <span id="total-score">0</span>
        </div>

        <div id="interview-container"></div>
    </div>

    <script>
        // === БАЗА ВОПРОСОВ И ОТВЕТОВ ===
        const questionBank = {
            "Industrial Craft 2": [
                { q: "Что делает улучшение \"Затягиватель\"?", a: "Втягивает предметы из хранилища" },
                { q: "Какой провод лучше использовать?", a: "Без разницы" },
                { q: "Как получить плутоний?", a: "Реактор, Репликатор, Пчела" },
                { q: "Чем конвертируется EU в RF?", a: "Power Converter и Квантовый конвентер" },
                { q: "Сколько в 1 EU RF?", a: "1 eu = 4 рф" },
                { q: "Как разъединить провода?", a: "Покрасить их валиком/аппликатором цвета в разные цвета" },
                { q: "Где брать дистилированную воду и для чего она используется?", a: "Парогенератор/Солнечный опреснитель. Вода используется для экономии крафта хладагента" },
                { q: "Какое количество улучшений каждого вида необходимо для хорошей работы механизмов?", a: "16-20 (синий), 6-8 (желтый), 4(красный)" },
                { q: "Как включить полёт на гравитационном желе?", a: "В настройках Gravi Fly Key" },
                { q: "Как получать хмель?", a: "Красная пшеница + красная пшеница, кофе + кофе, адский нарост + адский нарост, резиновый тростник + резиновый тростник" },
                { q: "Взрывается ли от перегрева ядерный реактор?", a: "Нет, но реактор пропадает" }
            ],
            "Thermal Expansion": [
                { q: "Для чего нужна красная печать? Как ей пользоваться?", a: "Нужна для переноса настроек механизмов" },
                { q: "Разница между сервомеханизмом и поисковиком?", a: "Первый забирает, второй всасывает предметы" },
                { q: "Для чего нужен тессеракт?", a: "Передавать предметы, жидкость, энергию на большое расстояние" },
                { q: "Какая труба передает больше всего RF?", a: "Криостабилизированная" },
                { q: "Какие цвета используются в настройках сторон механизмов и что они обозначают?", a: "Основные: синий и оранжевый, отвечают за вход/выход из механизма с определенной стороны, серый - и вход, и выход." },
                { q: "Какое максимальное расширение скорости работы можно установить в механизм?", a: "Квантовое расширение X64." },
                { q: "Какой принцип работы у автономного активатора?", a: "Имитация нажатия ЛКМ/ПКМ, может ставить блоки и ломать их" }
            ],
            "Applied Energistics 2": [
                { q: "Для чего нужен блок обработки создания?", a: "Увеличивает кол-во одновременных процессов крафта" },
                { q: "Какой максимальный куб МЭ Системы?", a: "Рамка 10x10x10." },
                { q: "Для чего нужна карта создания, карта нечёткости?", a: "Позволяет интерфейсам и шинам создавать предметы, если их нет в МЭ. Позволяет игнорировать метаданные" },
                { q: "Чем можно поддерживать уровень ресурса в МЭ?", a: "Поддержатель уровня, Излучатель уровня" },
                { q: "Чем можно забирать и поставлять ресурсы в мехи/хранилища?", a: "Шина импорта, Шина Экспорта (// Трубами в интерфейс)" },
                { q: "Не работает беспроводной терминал, что делать?", a: "Поставить терминал безопасности и беспроводную точку доступа, в неё положить улучшения" },
                { q: "Как можно передавать каналы на большое расстояние без кабелей?", a: "Беспроводной соединитель, квантовый мост" },
                { q: "Как копировать и передавать настройки точке, шинам и т.д. из AE2?", a: "Карта памяти" },
                { q: "Что делать если МЭ Система периодически включается и выключается?", a: "Поставить к МЭ кубу энергетические ячейки, желательно гибридные." },
                { q: "Как настроить ячейку под определенный ресурс?", a: "Разметить ячейку в верстаке ячеек" },
                { q: "Что нужно сделать чтобы соединить несколько МЭ Систем в одну?", a: "Провести из каждой МЭ Системы одну шину хранения и один МЭ интерфейс,\nрасположить их так, чтобы шина хранения одной МЭ Системы соединялась с МЭ интерфейсом второй системы. Если МЭ Систем больше 2 - аналогично по цепи." }
            ],
            "Thaumcraft": [
                { q: "Как получить наболдажник гномье проклятие?", a: "Торговаться с гномом, купить у Визера, при помощи Око визера" },
                { q: "Как узнать что нужно для открытия изучения \"ихор\"?", a: "Shift в неи на Ихор" },
                { q: "Как убрать заражение? (слизь, жидкость, пары)", a: "Лопата очистителя." },
                { q: "Для чего нужна мнемоническая матрица?", a: "Увеличивает кол-во запоминаемых крафтов в алхим. конструкции на 2" },
                { q: "Как сделать Наэлектризированное облако?", a: "Кликнуть заряженным аккумулятором(бронзовым) по обычному нитору" },
                { q: "Какие способы существуют для наполнения жезла висом?", a: "Станция для зарядки жезлов, синтезатор маны для жезлов, узел, плита зарядки жезлов (LoliUtility)" },
                { q: "Как получить сосуд багровый крови?", a: "Взять в инвентарь стеклянные пузырьки из Thaumcraft, бить ЛКМ полым кинжалом по живым мобам." },
                { q: "Для чего нужен и как работает магический сборщик?", a: "Автокрафты магического верстака, соеденить с помощью карты памяти интерфейс вис-реле и сборщик, шаблоны записываются на ядре знаний в высекателе знаний" },
                { q: "Как сменить/снять набалдашник?", a: "Change wand Focus/ shift + change wand focus" },
                { q: "Какие блоки увеличивают стабильность инфузии(матрицы)?", a: "Свечи, Кластеры, головы игроков, зомби, скелетов(и иссушителей), криперов, мецающие грибы, пилоны маны/гайа/природные, стабилизатор из лоли" },
                { q: "Почему некоторые узлы ауры вытягивают энергию из других?", a: "Узлы находящиеся на близком расстоянии могут передавать между собой аспекты \"молниями\" энергии (узел может передавать энергию в области 7 на 7 на 7 с ним в центре), чем дальше стоят узлы, тем медленнее идет передача." },
                { q: "Как можно превратить обычный узел в заряженный?", a: "Поставить узел-стабилизатор, на него узел и сверху Узел-преобразователь(запитать красным камнем)" },
                { q: "Как можно передать изучения другому игроку?", a: "Делать дубликаты свитков во время изучения(Иных способов нет)" },
                { q: "Что нужно для работы ПБ конструкции?", a: "Нужно хранилище, аспекты, нитор под тигелем" }
            ],
            "Botania + Alfheim": [
                { q: "Как получить головы Гайи и Флюгеля?", a: "Выбить элементиевым топором. (Удача работает, 3 = 33%)" },
                { q: "Как сделать пузырёк наполненный эндер-воздухом?", a: "ПКМ пузырьком в энде, крафт" },
                { q: "Тратятся ли руны на руническом алтаре?", a: "Вообще не тратятся" },
                { q: "Что нужно для убийства Флюгеля?", a: "Площадка как для Гайи, 40 блоков над землёй минимум, тиара флигель" },
                { q: "Как сделать анти-пилон?", a: "Возле Аномалии поставить пилон гайя и кликнуть духом гайя" },
                { q: "Какие цветы — хороший выбор для получения маны по этапам игры?", a: "Пламя края (горючее) - Тайная Роза(опыт) - Гурмарилис(еда) - Манатеплица - Асгародуванчик" },
                { q: "Для чего нужно семя разрастания?", a: "Не даёт высохнуть цветам + ускоряет цветы в 2 раза (те, которые и так не высыхают)" },
                { q: "Как призвать Флюгеля разных уровней и из какого падают реликвии?", a: "Глаз флюги, Душа флюги, Горн душ + фул душа флюгеля, релики из 3-го лвла" },
                { q: "Для чего нужен цветок Гибискус?", a: "Из низкой породы делает чистую породу пчелы" },
                { q: "Для чего нужен цветок Улейцинт?", a: "Создаёт простых пчёл за ману" },
                { q: "Как работает Тайная роза?", a: "Генерирующий ману за счёт поглощения опыта у игрока" },
                { q: "Для чего пустые слоты в мех. рун. алтаре?", a: "Улучшение: Асгард, Ген жизнекамня, стак" },
                { q: "Можно перепривязать реликвию к другому игроку?", a: "Золотом рейна можно очистить реликвию" },
                { q: "Как получить пыль Иффесалия?", a: "Добыть в мире Альфхейм, Душа флюги(убить флюгу)" },
                { q: "Не открывается портал альфхейм, что делать?", a: "Не хватка маны или неправильная конструкция" }
            ],
            "BloodMagic + Blood Arsenal": [
                { q: "Как сжать ритуал или алтарь из Blood Magic?", a: "Сжиматель душ с шаром внутри, при этом шар тратится" },
                { q: "Способ фарма крови на разных этапах игры?", a: "Кинжал жертвоприношения, ритуал Well of Suffering, Генератор Крови, Шар Армока" },
                { q: "Что делает предсказатель ритуала?", a: "Строит выбранный ритуал используя блоки в инвентаре" },
                { q: "Как активировать ритуал?", a: "Кристалл активации" },
                { q: "Как добыть осколки заражённой крови?", a: "Убить заражённого моба под слабостью 2." },
                { q: "Как посмотреть количество крови в алтаре?", a: "Сигил предсказания" },
                { q: "Для чего нужна руна дислокации?", a: "Увеличивает скорость передачи LP в алтарь и из него" },
                { q: "Как поставлять кровь из генератора крови в алтарь / МЭ?", a: "Материализатор жизненной эссенции + любой шар + редстоун сингал или ритуал Cry of The Eternal Soul." },
                { q: "Как можно просмотреть прогресс наполнения кровью на алтаре?", a: "Сигил Зрения" },
                { q: "Для чего кальцинатор и как он работает?", a: "для превращения реагента в AR, положить кровавый шар и реагент" },
                { q: "Как наполнить колпак реагентом?", a: "Для передачи жмём Шифт+ПКМ алхимическим маршрутизатором по кальцинатору, затем ПКМ по тому же кальцинатору и в конце ПКМ по стеклянному колпаку" }
            ],
            "Tinkers Construct": [
                { q: "Для чего нужна перчатка путешественника и как её улучшать?", a: "Быстрое копание, красный камень" },
                { q: "Как увеличить количество модификаторов?", a: "Алмазный блок + Золотое яблоко, Адская звезда, Золотой блок + Алмаз" },
                { q: "Какой модификатор добавляет авто-плавку на кирку?", a: "Лавовый кристалл" },
                { q: "Какой инструмент копает камень 3 на 3?", a: "Молот" },
                { q: "Как построить печь из данного мода?", a: "Обожжённый кирпич, контроллер плавильни, резервуар с лавой, слив плавильни." },
                { q: "Какой модификатор необходим для шёлкового касания?", a: "Шелковистая драгоценность" },
                { q: "Как улучшить инструменты на Удачу, Эффективность, Прочность?", a: "Лазурит, редстоун, алмаз/изумруд" }
            ],
            "Draconic Evolution": [
                { q: "Для чего нужен Связыватель кристаллов?", a: "Для настройки Энергетич. кристаллов" },
                { q: "Как улучшать броню и инструменты?", a: "Ядрами дракона в Модификационном столе" },
                { q: "Как призвать обычного дракона?", a: "12 кварц колонн + 4 алм. блока + 4 заряж. драк. блока + 1 камень воскрешения (4 светокамня + 4 обсы) либо сжатый камень воскрешения" },
                { q: "Есть ли полёт в виверн. броне/дк. броне?", a: "Только в драконьей броне" },
                { q: "Для чего нужен Улучшенный беспроводной энергетический передатчик?", a: "Чтобы подавать в механизмы энергию без проводов и прочих соединений" },
                { q: "Как получить душу моба?", a: "Убивать с зачарованием Жнец или оружием из самого мода" },
                { q: "Чем отличается спавнер хаоса от стабилизированного?", a: "Количеством слотов (11 слотов по 10 душ) и возможностью улучшить спавнер хаоса ядром хаоса и продвинутым ядром хаоса." },
                { q: "Какие есть способы телепортации в этом моде?", a: "Амулет телепортации; Усовершенствованный амулет телепортации" }
            ],
            "Forestry + Gendustry": [
                { q: "Какой эффект пчелы кормит узел?", a: "Empowering" },
                { q: "Как получать пыльцу с деревьев?", a: "Набор для сбора пыльцы" },
                { q: "Что делать если пчела не даёт доп. продукцию?", a: "Выставить ей правильные условия(биом)" },
                { q: "Оптимальное количество стимуляторов на продукцию при шансе на продукцию 1%?", a: "2 (максимальный эффект от ламп +1000%)" },
                { q: "Для чего нужна генная база данных мастера?", a: "Даёт возможность получить любой ген пчел/растений с помощью колбы в интерфейсе самой базы мастера" },
                { q: "Как получить личинку из данного мода?", a: "В биг улье, с улучшением \"Инкубатор личинок улья\"" },
                { q: "Чем со 100% шансом можно собирать саженцы из листвы?", a: "Садовый нож" }
            ],
            "Galacticraft": [
                { q: "Как найти нефть?", a: "в обычном мире найти" },
                { q: "С помощью какого механизма нефть можно преобразовать в топливо?", a: "очистительный завод" },
                { q: "Как сделать ракету 3 уровня?", a: "через ракетный цех или сборщик NASA" },
                { q: "Чем отличаются провода от Galacticraft от проводов разных модов?", a: "провода от галактика может передавать еу в рф, ic2 только eu" },
                { q: "Как добыть жёлтые фрукты?", a: "можно найти на Барнарде С" }
            ],
            "Ender IO": [
                { q: "С помощью какого предмета можно получить тот или иной зачар?", a: "Зачарователь" },
                { q: "Можно ли соединить провода в один блок?", a: "Можно" },
                { q: "Для чего нужен флакон душ?", a: "для записи и хранения души моба, чтобы затем использовать её в электрическом спаунере" },
                { q: "Какой блок может собирать урожай без замены земли?", a: "фермерская станция" },
                { q: "Зачем нужен шарик тёмной стали?", a: "делает больше шанс и дополнительный дроп на выпадение в дробителе" }
            ],
            "DivineRPG": [
                { q: "Как получить снежинки, а также как получить лук метели и лук из сосулек?", a: "Ломать замёрзший сундук в данжах в заснежье. Купить у Инженера мастерской в заснежье за снежинки." },
                { q: "Для чего нужна кровать кошмаров?", a: "Чтобы попасть в Везею." },
                { q: "Как попасть в Аркану, и с помощью чего можно открывать двери?", a: "Требуется 12 рамок портала Подземелья тайн, портал активируется автоматически.\nДвери можно открывать рычагом, а также ключом." },
                { q: "Как получить Молот Кароса?", a: "Купить у Голода Торговец везеи на 1-ом этаже за Каменные фрагменты (Из доктора Кароса.)" },
                { q: "Как призывать боссов, у которых есть свой алтарь?", a: "Огниво сноведений (Для Леди Луны Лунные часы), купить их можно у Голода." },
                { q: "Чем активировать порталы?", a: "Сумеречные часы, Снежный шар (для Заснежья)." },
                { q: "Как получить коготь Арксиана и сколько необходимо глыб для создания?", a: "В Везеи, на столе наполнения совместить Шаблон когтя и Глыбы Аксиана, 21 глыба." },
                { q: "Как получить Халитовый сет, лук, клинок и молниеносный?", a: "Денсос и Рейвор (Поножи и нагрудник), Вечный Лучник (Шлем и ботинки), Сумеречный демон (лук), Вамашерон (меч), Леди луна (молниеносный)." }
            ],
            "LOLILAND": [
                { q: "Чем отличаются уровни генераторов жидкой материи?", a: "Больше материи за ту же энергию (11 mB за 1kk EU - 10 лвл материи)" },
                { q: "Как работает синтезатор магических слитков?", a: "Кладёшь кольцо маны/планшет и крафтишь" },
                { q: "Как автоматизировать 9×9 крафты?", a: "Ужасающий автоматический верстак, молекулярный сборщик (Экстремальный)" },
                { q: "Какая разница между обычными механизмами и промышленными?", a: "12 слотов (Но они медленнее с 24+ ускорителями)" },
                { q: "Как сделать автокрафт предметов, которые крафтятся на матрице?", a: "Молекулярный сборщик (Матричный) или трубы к пъедесталам + Редстоун-активатор матрицы" },
                { q: "Как поставлять в реагентную кузню реагенты?", a: "Нужно поставить колпаки наполненые нужными реагентами рядом с кузней" },
                { q: "Что нужно для работы совершенной пасеки? За что отвечают аспекты, мана?", a: "ЕU энергия для работы. Мана - пчёлы не умирают и игнорируют условия, Аспекты - увеличивают эффективность пчёл" },
                { q: "В чём разница между улучшенным механическим бассейном маны и его легендарной версией?", a: "Удваивает выход продукции, слот для Магическое улучшение стак" },
                { q: "Для чего нужна инфернальная печь? Как её автоматизировать? Почему инфернальная печь перестала плавить аспекты?", a: "Переплавляет предметы в аспекты. \nС помощью шины хранения эссенций можно извлекать аспекты. С помощью \"Distillation pattern Encoder\" можно делать шаблоны для аспектов.\nИнфернальная печь переполнена аспектами" },
                { q: "С помощью чего можно получать эфирные эссенции?", a: "Убийство сущности \"Wisp\", с души данного существа, евкливдовый генератор." },
                { q: "Как работает Евклидовый генератор?", a: "Работает за счёт маны, генерирует эфирные эссенции" },
                { q: "Как работает резонатор крови и маны?", a: "Крови - позволяет запитывать механизмы кровь из МЭ. Маны - позволяет хранить и отдавать ману из МЭ, можно установить искру." },
                { q: "В чём разница между обычной и совершенной центрифугой?", a: "Совершенная центрифуга со 100% шансом перерабатывает продукцию" },
                { q: "Для чего нужна мультитеплица? Из чего она строится и как её собрать?", a: "Позволяет вырабатывать ману с помощью цветов из Botania. Ядро мультитеплицы, Основу мультитеплицы, Темный манакамень и Манастекло - собрать посохом леса" },
                { q: "Чем можно быстро поднять и очистить искажение?", a: "Свиток искажения, Свиток очищения" },
                { q: "Что нужно для постройки и активации \"Алхимический синтезатор\"?", a: "Строится из Алхимического покрытия, Алхимического стекла, Алхимического ядра и Алхимического рунного камня. Активируется с помощью жезла из Thaumcraft." },
                { q: "В чём разница между репликатором и его легендарной версией? Из чего он строится и как активируется?", a: "Имеет 9 слотов для создания предметов\nСтроится из Квантового покрытия, Ядра квантового репликатора, Квантового стекла и Квантовой основы. Для активации нужно кликнуть ПКМ Квантовым инструментом сборки." },
                { q: "Что нужно для постройки и активации \"Смеситель\"?", a: "Создаётся из Корпуса смесителя, Стекла смесителя, Резервуара смесителя и Ядра смесителя. Собирается квантовым инструментом сборки" },
                { q: "Как получать энергию хаоса? Из чего строится данная структура и чем активируется?", a: "С помощью внеземного генератора энергии хаоса. Положите в интерфейс механизма Осколок Хаоса, чтобы начать генерировать Энергию Хаоса. Он не расходуется и не исчезает — с его помощью можно генерировать Энергию Хаоса бесконечно. Ускорьте процесс генерации, используя Внеземной катализатор энергии. Одновременно можно положить сразу 2 Катализатора.\n\nСоздаётся из новых блоков: Внеземного покрытия, Внеземной основы, Ядра внеземного генератора энергии Хаоса и Внеземного стекла. Собирается внеземным активатором структур" },
                { q: "Как передавать энергию хаоса?", a: "С помощью передатчика энергии хаоса. Чтобы связать межу собой два передатчимка нужно использовать \"Связыватель энергии хаоса\"" },
                { q: "Из чего собирается Внеземной преобразователь душ?", a: "Создаётся из Внеземного покрытия, Внеземной основы, Ядра внеземного преобразователя душ и Внеземного стекла. Собирается внеземным активатором структур" },
                { q: "Как работает кодекс жизни?", a: "Помогает получить любых пчел, деревьев, бабочков&мотыльков, цветы" },
                { q: "Можно ли копировать шаблоны на дисках, ядрах знаний?", a: "Да, с помощью блока \"Станция дублированния знаний\"" }
            ]
        };

        let generatedQuestions = [];
        let currentScores = {};

        function saveUserData() {
            localStorage.setItem('interviewee', document.getElementById('interviewee').value);
            localStorage.setItem('interviewer', document.getElementById('interviewer').value);
        }
        function loadUserData() {
            document.getElementById('interviewee').value = localStorage.getItem('interviewee') || '';
            document.getElementById('interviewer').value = localStorage.getItem('interviewer') || '';
        }

        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function updateScores() {
            let total = 0;
            const modScores = {};
            Object.keys(currentScores).forEach(id => {
                const score = currentScores[id];
                const mod = document.querySelector(`[data-id="${id}"]`).dataset.mod;
                modScores[mod] = (modScores[mod] || 0) + score;
                total += score;
            });
            document.getElementById('total-score').textContent = total;
            Object.keys(modScores).forEach(mod => {
                const el = document.querySelector(`.mod-section[data-mod="${mod}"] .mod-score`);
                if (el) el.textContent = modScores[mod];
            });
        }

        function createQuestionCard(mod, questionObj, index) {
            const id = `${mod}-${index}`;
            const card = document.createElement('div');
            card.className = 'question-card';
            card.dataset.id = id;
            card.dataset.mod = mod;
            let score = currentScores[id] ?? null;
            const plusActive = score === 1 ? 'active' : '';
            const minusActive = score === 0 ? 'active' : '';
            card.innerHTML = `
                <div class="question-text">${questionObj.q}</div>
                <div class="answer">${questionObj.a}</div>
                <div class="score-buttons">
                    <button class="score-btn plus ${plusActive}" data-value="1">+</button>
                    <button class="score-btn minus ${minusActive}" data-value="0">–</button>
                    <button class="remove-btn">Удалить</button>
                </div>
            `;
            card.querySelector('.plus').addEventListener('click', () => {
                currentScores[id] = 1;
                card.querySelector('.plus').classList.add('active');
                card.querySelector('.minus').classList.remove('active');
                updateScores();
            });
            card.querySelector('.minus').addEventListener('click', () => {
                currentScores[id] = 0;
                card.querySelector('.minus').classList.add('active');
                card.querySelector('.plus').classList.remove('active');
                updateScores();
            });
            card.querySelector('.remove-btn').addEventListener('click', () => {
                delete currentScores[id];
                card.remove();
                updateScores();
            });
            return card;
        }

        function generateQuestions() {
            saveUserData();
            const container = document.getElementById('interview-container');
            container.innerHTML = '';
            currentScores = {};
            const count = parseInt(document.getElementById('question-count').value) || 5;
            generatedQuestions = [];

            Object.entries(questionBank).forEach(([mod, questions]) => {
                const actualCount = Math.min(count, questions.length);
                const shuffled = shuffleArray(questions);
                const selected = shuffled.slice(0, actualCount);
                generatedQuestions.push(...selected.map((q, i) => ({ mod, q, i })));
                const section = document.createElement('div');
                section.className = 'mod-section';
                section.dataset.mod = mod;
                section.innerHTML = `
                    <div class="mod-header">
                        <div class="mod-name">${mod}</div>
                        <div class="mod-score">0</div>
                    </div>
                `;
                selected.forEach((item, idx) => {
                    section.appendChild(createQuestionCard(mod, item.q, idx));
                });
                container.appendChild(section);
            });
            updateScores();
        }

        function restoreQuestions() {
            generateQuestions();
        }

        function exportReport() {
            saveUserData();
            const interviewee = document.getElementById('interviewee').value || 'Не указано';
            const interviewer = document.getElementById('interviewer').value || 'Не указано';
            const date = new Date().toISOString().split('T')[0];
            const total = parseInt(document.getElementById('total-score').textContent);
            const modScores = {};
            document.querySelectorAll('.mod-section').forEach(section => {
                const mod = section.dataset.mod;
                const score = parseInt(section.querySelector('.mod-score').textContent);
                modScores[mod] = score;
            });
            const answers = [];
            Object.entries(currentScores).forEach(([id, score]) => {
                const card = document.querySelector(`[data-id="${id}"]`);
                if (!card) return;
                const mod = card.dataset.mod;
                const qText = card.querySelector('.question-text').textContent;
                const aText = card.querySelector('.answer').textContent;
                answers.push({ mod, question: qText, answer: aText, score });
            });
            const report = {
                interviewee,
                interviewer,
                date,
                totalScore: total,
                modScores,
                answers
            };
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sobesedovanie-${interviewee.replace(/\s+/g, '_')}-${date}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Инициализация
        document.getElementById('generate-btn').addEventListener('click', generateQuestions);
        document.getElementById('restore-btn').addEventListener('click', restoreQuestions);
        document.getElementById('export-btn').addEventListener('click', exportReport);
        loadUserData();
        generateQuestions();
    </script>
</body>
</html>
